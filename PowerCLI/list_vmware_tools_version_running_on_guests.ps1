#get-vm | Foreach-Object {$vm=$_; $_} | % { get-view $_.ID } | select Name,@{Name="ToolsStatus";Expression={$_.guest.toolsstatus}},@{Name="ToolsVersion"; Expression={$_.config.tools.toolsVersion}}, @{ Name="CPUs"; Expression={$vm.NumCPU}}, @{ Name="Memory"; Expression={$vm.MemoryMB}}, @{Name="IP"; Expression={$_.guest.ipaddress}} | export-csv c:\vmtoolsver_$date.csv
get-vm | % { get-view $_.ID } | select Name, @{ Name="hostName"; Expression={$_.guest.hostName}}, @{ Name="ToolsStatus"; Expression={$_.guest.toolsstatus}}, @{ Name="ToolsVersion"; Expression={$_.config.tools.toolsVersion}} | sort-object name | ConvertTo-HTML -head $a | Set-Content C:\export-tools.htm
get-vm | Foreach-Object {$vm=$_; $_} | % { get-view $_.ID } | select Name, @{ Name="hostName"; Expression={$_.guest.hostName}}, @{ Name="ToolsStatus"; Expression={$_.guest.toolsstatus}}, @{ Name="ToolsVersion"; Expression={$_.config.tools.toolsVersion}}, @{ Name="CPUs"; Expression={$vm.NumCPU}}, @{ Name="Memory"; Expression={$vm.MemoryMB}}, @{Name="IP"; Expression={$_.guest.ipaddress}} | sort-object name | ConvertTo-HTML -head $a | Set-Content C:\export-tools.htm